<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Ancestral State Reconstruction Under Mk2/Mkn — asr-mkn • diversitree</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Ancestral State Reconstruction Under Mk2/Mkn — asr-mkn"><meta property="og:description" content="Perform ancestral state reconstruction under Mk2 and other
  constant rate Markov models.  Marginal, joint, and stochastic
  reconstructions are supported.  Documentation is still in an early
  stage, and mostly in terms of examples."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">diversitree</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.10-0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Ancestral State Reconstruction Under Mk2/Mkn</h1>

    <div class="hidden name"><code>asr-mkn.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Perform ancestral state reconstruction under Mk2 and other
  constant rate Markov models.  Marginal, joint, and stochastic
  reconstructions are supported.  Documentation is still in an early
  stage, and mostly in terms of examples.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'mkn'</span></span>
<span><span class="fu"><a href="asr.html">make.asr.marginal</a></span><span class="op">(</span><span class="va">lik</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'mkn'</span></span>
<span><span class="fu"><a href="asr.html">make.asr.joint</a></span><span class="op">(</span><span class="va">lik</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'mkn'</span></span>
<span><span class="fu"><a href="asr.html">make.asr.stoch</a></span><span class="op">(</span><span class="va">lik</span>, slim<span class="op">=</span><span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <p></p>
<dl><dt id="arg-lik">lik<a class="anchor" aria-label="anchor" href="#arg-lik"></a></dt>
<dd><p>A likelihood function, returned by <code>make.mk2</code> or
    <code>make.mkn</code>.</p></dd>


  <dt id="arg-slim">slim<a class="anchor" aria-label="anchor" href="#arg-slim"></a></dt>
<dd><p>Should the history object be slimmed down?</p></dd>


  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments; currently ignored.</p></dd>

  </dl><p><!-- % TODO: This needs documenting. --></p>
<p><!-- %   \item{pars}{A vector of parameters, suitable for \code{lik}.} --></p>
<p><!-- %   \item{nodes}{For \code{asr.marginal} only; an optional vector of -->
<!-- %     nodes to return ancestral states for (using ape's index).  By -->
<!-- %     default, all nodes are returned.} --></p>
<p><!-- %   \item{root}{Behaviour at the root.  See \code{\link{make.bisse}} for -->
<!-- %     details and possible values.} --></p>
<p><!-- %   \item{root.p}{Root weightings for use when \code{root=ROOT.GIVEN}. -->
<!-- %     See \code{\link{make.bisse}} for details.} --></p>
<p><!-- %   \item{n}{The number of samples to draw from the joint distribution, or -->
<!-- %     number of stochastic reconstructions to make.} --></p>
<p><!-- %   \item{simplify}{For \code{asr.joint}, return a vector of states when -->
<!-- %     \code{n=1}? Otherwise leaves as a one row matrix.} --></p>
<p><!-- %   \item{intermediates}{Logical: Return intermediates as an attribute? -->
<!-- %     Used internally, and probably not of general interest.} --></p>
<p><!-- %   \item{...}{Additional arguments passed through to future methods. -->
<!-- %     Currently unused.} --></p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Output will differ slightly when <code>mk2</code> and <code>mkn</code> models are
  used as <code>lik</code>, as <code>mk2</code> uses states 0/1, while 2-state
  <code>mkn</code> uses 1/2.</p>
<p>This is all quite slow.  Faster versions are coming eventually.</p>
<p>These functions all return functions that generate different types of
  ancestral reconstruction.
  <!-- %The function returned by \code{make.asr.marginal} generates marginal -->
  <!-- %ancestral reconstructions, and has definition --></p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Richard G. FitzJohn</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## Start with a simple tree evolved under a constant rates birth-death</span></span></span>
<span class="r-in"><span><span class="co">## model with asymetric character evolution</span></span></span>
<span class="r-in"><span><span class="va">pars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.1</span>, <span class="fl">.1</span>, <span class="fl">.03</span>, <span class="fl">.03</span>, <span class="fl">.03</span>, <span class="fl">.06</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">phy</span> <span class="op">&lt;-</span> <span class="fu"><a href="simulate.html">trees</a></span><span class="op">(</span><span class="va">pars</span>, <span class="st">"bisse"</span>, max.taxa<span class="op">=</span><span class="fl">50</span>, max.t<span class="op">=</span><span class="cn">Inf</span>, x0<span class="op">=</span><span class="fl">0</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Here is the true history.  The root node appears to be state 1 (red)</span></span></span>
<span class="r-in"><span><span class="co">## at the root, despite specifying a root of state 0 (x0=0, in statement</span></span></span>
<span class="r-in"><span><span class="co">## above).  This is because the tree started with a single lineage, but</span></span></span>
<span class="r-in"><span><span class="co">## had changed state by the time the first speciation event happened.</span></span></span>
<span class="r-in"><span><span class="va">h</span> <span class="op">&lt;-</span> <span class="fu"><a href="history.from.sim.html">history.from.sim.discrete</a></span><span class="op">(</span><span class="va">phy</span>, <span class="fl">0</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">h</span>, <span class="va">phy</span>, main<span class="op">=</span><span class="st">"True history"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="asr-mkn-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## All of the methods need a likelihood function; build a mk2 function:</span></span></span>
<span class="r-in"><span><span class="va">lik</span> <span class="op">&lt;-</span> <span class="fu"><a href="make.mkn.html">make.mk2</a></span><span class="op">(</span><span class="va">phy</span>, <span class="va">phy</span><span class="op">$</span><span class="va">tip.state</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Using the true parameters, compute the marginal ancestral state</span></span></span>
<span class="r-in"><span><span class="co">## reconstructions:</span></span></span>
<span class="r-in"><span><span class="va">st.m</span> <span class="op">&lt;-</span> <span class="fu"><a href="asr.html">asr.marginal</a></span><span class="op">(</span><span class="va">lik</span>, <span class="va">pars</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## There is still not a good stand-alone plotting command for nodes.</span></span></span>
<span class="r-in"><span><span class="co">## For now, use ape's nodelabels().</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">h</span>, <span class="va">phy</span>, main<span class="op">=</span><span class="st">"Marginal ASR"</span>, show.node.state<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">nodelabels</span><span class="op">(</span>thermo<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">st.m</span><span class="op">)</span>, piecol<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, cex<span class="op">=</span><span class="fl">.5</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="asr-mkn-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Again, with the true parameters, a sample from the joint</span></span></span>
<span class="r-in"><span><span class="co">## distribution:</span></span></span>
<span class="r-in"><span><span class="va">st.j</span> <span class="op">&lt;-</span> <span class="fu"><a href="asr.html">asr.joint</a></span><span class="op">(</span><span class="va">lik</span>, <span class="va">pars</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Plotting this sample against the true values.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">h</span>, <span class="va">phy</span>, main<span class="op">=</span><span class="st">"Joint ASR"</span>, show.node.state<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">nodelabels</span><span class="op">(</span>pch<span class="op">=</span><span class="fl">19</span>, col<span class="op">=</span><span class="va">st.j</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="asr-mkn-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## This is just one sample, and is not very accurate in this case!  Make</span></span></span>
<span class="r-in"><span><span class="co">## 1,000 such samples and average them:</span></span></span>
<span class="r-in"><span><span class="va">st.j2</span> <span class="op">&lt;-</span> <span class="fu"><a href="asr.html">asr.joint</a></span><span class="op">(</span><span class="va">lik</span>, <span class="va">pars</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span>, <span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">st.j2.mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">st.j2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">h</span>, <span class="va">phy</span>, main<span class="op">=</span><span class="st">"Joint ASR (averaged)"</span>, show.node.state<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">nodelabels</span><span class="op">(</span>thermo<span class="op">=</span><span class="fl">1</span><span class="op">-</span><span class="va">st.j2.mean</span>, piecol<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, cex<span class="op">=</span><span class="fl">.5</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="asr-mkn-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Check the estimates against one another:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">st.m</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span>, <span class="va">st.j2.mean</span>, xlab<span class="op">=</span><span class="st">"Marginal"</span>, ylab<span class="op">=</span><span class="st">"Joint"</span>, las<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="asr-mkn-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Finally, the stochastic character mapping.  This uses samples from</span></span></span>
<span class="r-in"><span><span class="co">## the joint distribution at its core.</span></span></span>
<span class="r-in"><span><span class="va">st.s</span> <span class="op">&lt;-</span> <span class="fu"><a href="asr.html">asr.stoch</a></span><span class="op">(</span><span class="va">lik</span>, <span class="va">pars</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">st.s</span>, <span class="va">phy</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="asr-mkn-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Again, multiple samples can be done at once.  There is a function for</span></span></span>
<span class="r-in"><span><span class="co">## summarising histories, but it is still in the works.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Repeating the above with a two-state mkn model:</span></span></span>
<span class="r-in"><span><span class="va">lik2</span> <span class="op">&lt;-</span> <span class="fu"><a href="make.mkn.html">make.mkn</a></span><span class="op">(</span><span class="va">phy</span>, <span class="va">phy</span><span class="op">$</span><span class="va">tip.state</span> <span class="op">+</span> <span class="fl">1</span>, <span class="fl">2</span>, <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Everything works:</span></span></span>
<span class="r-in"><span><span class="va">st2.m</span> <span class="op">&lt;-</span> <span class="fu"><a href="asr.html">asr.marginal</a></span><span class="op">(</span><span class="va">lik2</span>, <span class="va">pars</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">st2.j</span> <span class="op">&lt;-</span> <span class="fu"><a href="asr.html">asr.joint</a></span><span class="op">(</span><span class="va">lik2</span>, <span class="va">pars</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span>, <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">st2.s</span> <span class="op">&lt;-</span> <span class="fu"><a href="asr.html">asr.stoch</a></span><span class="op">(</span><span class="va">lik2</span>, <span class="va">pars</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Marginal likelihoods agree:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">st.m</span>, <span class="va">st2.m</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span><span class="co">## Joint reconstructions are stochastic, so just check with a</span></span></span>
<span class="r-in"><span><span class="co">## regression:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">st2.j</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">st.j2</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lm(formula = colMeans(st2.j) - 1 ~ colMeans(st.j2) - 1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Min      1Q  Median      3Q     Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.3390 -0.3276 -0.2179  0.2642  0.3337 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> colMeans(st.j2)   0.3343     0.0282   11.86 7.23e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual standard error: 0.2867 on 48 degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multiple R-squared:  0.7454,	Adjusted R-squared:  0.7401 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F-statistic: 140.6 on 1 and 48 DF,  p-value: 7.228e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Integrate parameter uncertainty, and see how far down the tree there</span></span></span>
<span class="r-in"><span><span class="co">## is any real information on parameter states for this tree (this takes</span></span></span>
<span class="r-in"><span><span class="co">## about 6s)</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="make.prior.html">make.prior.exponential</a></span><span class="op">(</span><span class="fl">.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="mcmc.html">mcmc</a></span><span class="op">(</span><span class="va">lik</span>, <span class="va">pars</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span>, <span class="fl">1000</span>, w<span class="op">=</span><span class="fl">1</span>, prior<span class="op">=</span><span class="va">prior</span>, print.every<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">st.m.avg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowMeans</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">samples</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, <span class="fl">1</span>, <span class="va">asr.joint</span>, lik<span class="op">=</span><span class="va">lik</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">h</span>, <span class="va">phy</span>, main<span class="op">=</span><span class="st">"MCMC Averaged ASR"</span>, show.node.state<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">nodelabels</span><span class="op">(</span>thermo<span class="op">=</span><span class="fl">1</span> <span class="op">-</span> <span class="va">st.m.avg</span>, piecol<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, cex<span class="op">=</span><span class="fl">.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Richard G. FitzJohn, Emma Goldberg, Karen Magnuson-Ford, Roger Sidje.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>


<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Cladogenetic State change Speciation and Extinction Model — make.classe • diversitree</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Cladogenetic State change Speciation and Extinction Model — make.classe"><meta property="og:description" content="Prepare to run ClaSSE (Cladogenetic State change
  Speciation and Extinction) on a phylogenetic tree and character
  distribution.  This function creates a likelihood function that can be
  used in maximum likelihood or Bayesian
  inference."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">diversitree</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.9-18</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Cladogenetic State change Speciation and Extinction Model</h1>
    
    <div class="hidden name"><code>make.classe.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Prepare to run ClaSSE (Cladogenetic State change
  Speciation and Extinction) on a phylogenetic tree and character
  distribution.  This function creates a likelihood function that can be
  used in <a href="find.mle.html">maximum likelihood</a> or <a href="mcmc.html">Bayesian</a>
  inference.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">make.classe</span><span class="op">(</span><span class="va">tree</span>, <span class="va">states</span>, <span class="va">k</span>, sampling.f<span class="op">=</span><span class="cn">NULL</span>, strict<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>              control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu">starting.point.classe</span><span class="op">(</span><span class="va">tree</span>, <span class="va">k</span>, eps<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>tree</dt>
<dd><p>An ultrametric bifurcating phylogenetic tree, in
    <code>ape</code> “phylo” format.</p></dd>


  <dt>states</dt>
<dd><p>A vector of character states, each of which must be an
    integer between 1 and <code>k</code>.  This vector must have names that
    correspond to the tip labels in the phylogenetic tree
    (<code>tree$tip.label</code>).</p></dd>


  <dt>k</dt>
<dd><p>The number of states.  (The maximum now is 31, but that can
    easily be increased if necessary.)</p></dd>

  
  <dt>sampling.f</dt>
<dd><p>Vector of length <code>k</code> where <code>sampling.f[i]</code>
    is the proportion of species in state <code>i</code> that are present in
    the phylogeny.  A value of <code>c(0.5, 0.75, 1)</code> means that half of
    species in state 1, three quarters of species in state 2, and all
    species in state 3 are included in the phylogeny.  By default all
    species are assumed to be known</p></dd>


  <dt>strict</dt>
<dd><p>The <code>states</code> vector is always checked to make sure
    that the values are integers on <code>1:k</code>.  If <code>strict</code> is
    <code>TRUE</code> (the default), then the additional check is made that
    <em>every</em> state is present.  The likelihood models tend to be
    poorly behaved where states are missing, but there are cases
    (missing intermediate states for meristic characters) where allowing
    such models may be useful.</p></dd>


  <dt>control</dt>
<dd><p>List of control parameters for the ODE solver.  See
    details in <code><a href="make.bisse.html">make.bisse</a></code>.</p></dd>


  <dt>eps</dt>
<dd><p>Ratio of extinction to speciation rates to be used when
    choosing a starting set of parameters.  The procedure used is based
    on Magallon &amp; Sanderson (2001).</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>The ClaSSE model with <code>k = 2</code> is equivalent to but a different
  parameterization than the <a href="make.bisseness.html">BiSSE-ness</a> model.
  The <a href="make.geosse.html">GeoSSE</a> model can be constructed from ClaSSE
  with <code>k = 3</code>; see the example below.</p>
<p><code>make.classe</code> returns a function of class <code>classe</code>.  The
  arguments and default values for this function are:</p>
<p></p><div class="sourceCode"><pre><code><span></span>
<span>    <span class="fu">f</span><span class="op">(</span><span class="va">pars</span>, condition.surv<span class="op">=</span><span class="cn">TRUE</span>, root<span class="op">=</span><span class="va">ROOT.OBS</span>, root.p<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>      intermediates<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span>  </span></code></pre></div>

<p>The arguments of this function are explained in <a href="make.bisse.html">make.bisse</a>.
  The speciation rate parameters are lambda_ijk, ordered with k changing
  fastest and insisting on j &lt; k.</p>
<p>With more than 9 states, lambda_ijk and q_ij can be ambiguous (e.g. is
  q113 1-&gt;13 or 11-&gt;3?).  To avoid this, the numbers are zero padded (so
  that the above would be q0113 or q1103 for 1-&gt;13 and 11-&gt;3
  respectively).  It might be easier to rename the arguments in practice
  though.  More human-friendly handling of large speciation rate arrays
  is in the works.</p>
<p><code>starting.point.classe</code> produces a first-guess set of parameters,
    ignoring character states.</p>
<p>Unresolved clade methods are not available for ClaSSE.</p>
<p>Tree simulation methods are not yet available for ClaSSE.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="constrain.html">constrain</a></code> for making submodels, <code><a href="find.mle.html">find.mle</a></code>
  for ML parameter estimation, and <code><a href="mcmc.html">mcmc</a></code> for MCMC
  integration.  The help page for <code><a href="find.mle.html">find.mle</a></code> has further
  examples of ML searches on full and constrained BiSSE models.  Things
  work similarly for ClaSSE, just with different speciation parameters.</p>  	
<p><code><a href="make.bisse.html">make.bisse</a></code>, <code><a href="make.bisseness.html">make.bisseness</a></code>,
  <code><a href="make.geosse.html">make.geosse</a></code>, <code><a href="make.musse.html">make.musse</a></code> for similar models
  and further relevant examples.</p></div>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>FitzJohn R.G., Maddison W.P., and Otto S.P. 2009. Estimating
  trait-dependent speciation and extinction rates from incompletely
  resolved phylogenies. Syst. Biol. 58:595-611.</p>  
<p>Goldberg E.E. and Igic B. Tempo and mode in plant breeding system
  evolution. In review.</p>
<p>Maddison W.P., Midford P.E., and Otto S.P. 2007. Estimating a binary
  character's effect on speciation and extinction. Syst. Biol.
  56:701-710.</p>
<p>Magallon S. and Sanderson M.J. 2001. Absolute diversification rates in
  angiospem clades. Evol. 55:1762-1780.</p>
<p>Magnuson-Ford, K., and Otto, S.P. 2012. Linking the investigations of
  character evolution and species diversification.  American Naturalist,
  in press.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Emma E. Goldberg</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## Due to a change in sample() behaviour in newer R it is necessary to</span></span></span>
<span class="r-in"><span><span class="co">## use an older algorithm to replicate the previous examples</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric_version.html" class="external-link">getRversion</a></span><span class="op">(</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="st">"3.6.0"</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">RNGkind</a></span><span class="op">(</span>sample.kind <span class="op">=</span> <span class="st">"Rounding"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>non-uniform 'Rounding' sampler used</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## GeoSSE equivalence</span></span></span>
<span class="r-in"><span><span class="co">## Same tree simulated in ?make.geosse</span></span></span>
<span class="r-in"><span><span class="va">pars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">0.5</span>, <span class="fl">1.0</span>, <span class="fl">0.7</span>, <span class="fl">0.7</span>, <span class="fl">2.5</span>, <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">pars</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">diversitree</span><span class="fu">:::</span><span class="fu">default.argnames.geosse</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">phy</span> <span class="op">&lt;-</span> <span class="fu"><a href="simulate.html">tree.geosse</a></span><span class="op">(</span><span class="va">pars</span>, max.t<span class="op">=</span><span class="fl">4</span>, x0<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">lik.g</span> <span class="op">&lt;-</span> <span class="fu"><a href="make.geosse.html">make.geosse</a></span><span class="op">(</span><span class="va">phy</span>, <span class="va">phy</span><span class="op">$</span><span class="va">tip.state</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pars.g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">0.5</span>, <span class="fl">1.0</span>, <span class="fl">0.7</span>, <span class="fl">0.7</span>, <span class="fl">1.4</span>, <span class="fl">1.3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">pars.g</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="argnames.html">argnames</a></span><span class="op">(</span><span class="va">lik.g</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">lik.c</span> <span class="op">&lt;-</span> <span class="fu">make.classe</span><span class="op">(</span><span class="va">phy</span>, <span class="va">phy</span><span class="op">$</span><span class="va">tip.state</span><span class="op">+</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pars.c</span> <span class="op">&lt;-</span> <span class="fl">0</span> <span class="op">*</span> <span class="fu">starting.point.classe</span><span class="op">(</span><span class="va">phy</span>, <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pars.c</span><span class="op">[</span><span class="st">'lambda222'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">pars.c</span><span class="op">[</span><span class="st">'lambda112'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">pars.g</span><span class="op">[</span><span class="st">'sA'</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">pars.c</span><span class="op">[</span><span class="st">'lambda333'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">pars.c</span><span class="op">[</span><span class="st">'lambda113'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">pars.g</span><span class="op">[</span><span class="st">'sB'</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">pars.c</span><span class="op">[</span><span class="st">'lambda123'</span><span class="op">]</span> <span class="op">&lt;-</span>  <span class="va">pars.g</span><span class="op">[</span><span class="st">'sAB'</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">pars.c</span><span class="op">[</span><span class="st">'mu2'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">pars.c</span><span class="op">[</span><span class="st">'q13'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">pars.g</span><span class="op">[</span><span class="st">'xA'</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">pars.c</span><span class="op">[</span><span class="st">'mu3'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">pars.c</span><span class="op">[</span><span class="st">'q12'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">pars.g</span><span class="op">[</span><span class="st">'xB'</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">pars.c</span><span class="op">[</span><span class="st">'q21'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">pars.g</span><span class="op">[</span><span class="st">'dA'</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">pars.c</span><span class="op">[</span><span class="st">'q31'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">pars.g</span><span class="op">[</span><span class="st">'dB'</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">lik.g</span><span class="op">(</span><span class="va">pars.g</span><span class="op">)</span>   <span class="co"># -175.7685</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -175.7685</span>
<span class="r-in"><span><span class="fu">lik.c</span><span class="op">(</span><span class="va">pars.c</span><span class="op">)</span>   <span class="co"># -175.7685</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -175.7685</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Richard G. FitzJohn, Emma Goldberg, Karen Magnuson-Ford, Roger Sidje.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>


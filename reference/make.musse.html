<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>MuSSE: Multi-State Speciation and Extinction — make.musse • diversitree</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="MuSSE: Multi-State Speciation and Extinction — make.musse"><meta property="og:description" content="Prepare to run MuSSE (Multi-State Speciation and
  Extinction) on a phylogenetic tree and character distribution.  This
  function creates a likelihood function that can be used in
  maximum likelihood or Bayesian
  inference.
MuSSE is agnostic as to whether multiple states or multiple traits are
  modelled (following Pagel 1994).  Instead, a transition rate matrix
  amongst possible trait/state combinations is constructed and the
  analysis is conducted on this.
The helper function make.musse.multitrait wraps the
  basic MuSSE model for the case of a combination of several binary
  traits; its argument handling are a little different; please see the
  help page for more information."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">diversitree</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.9-23</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>MuSSE: Multi-State Speciation and Extinction</h1>

    <div class="hidden name"><code>make.musse.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Prepare to run MuSSE (Multi-State Speciation and
  Extinction) on a phylogenetic tree and character distribution.  This
  function creates a likelihood function that can be used in
  <a href="find.mle.html">maximum likelihood</a> or <a href="mcmc.html">Bayesian</a>
  inference.</p>
<p>MuSSE is agnostic as to whether multiple states or multiple traits are
  modelled (following Pagel 1994).  Instead, a transition rate matrix
  amongst possible trait/state combinations is constructed and the
  analysis is conducted on this.</p>
<p>The helper function <code><a href="make.musse.multitrait.html">make.musse.multitrait</a></code> wraps the
  basic MuSSE model for the case of a combination of several binary
  traits; its argument handling are a little different; please see the
  help page for more information.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">make.musse</span><span class="op">(</span><span class="va">tree</span>, <span class="va">states</span>, <span class="va">k</span>, sampling.f<span class="op">=</span><span class="cn">NULL</span>, strict<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>           control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">starting.point.musse</span><span class="op">(</span><span class="va">tree</span>, <span class="va">k</span>, q.div<span class="op">=</span><span class="fl">5</span>, yule<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <p></p>
<dl><dt id="arg-tree">tree<a class="anchor" aria-label="anchor" href="#arg-tree"></a></dt>
<dd><p>An ultrametric bifurcating phylogenetic tree, in
    <code>ape</code> “phylo” format.</p></dd>


  <dt id="arg-states">states<a class="anchor" aria-label="anchor" href="#arg-states"></a></dt>
<dd><p>A vector of character states, each of which must be an
    integer between 1 and <code>k</code>.  This vector must have names that
    correspond to the tip labels in the phylogenetic tree
    (<code>tree$tip.label</code>).  For tips corresponding to unresolved
    clades, the state should be <code>NA</code>.</p></dd>


  <dt id="arg-k">k<a class="anchor" aria-label="anchor" href="#arg-k"></a></dt>
<dd><p>The number of states.</p></dd>


  <dt id="arg-sampling-f">sampling.f<a class="anchor" aria-label="anchor" href="#arg-sampling-f"></a></dt>
<dd><p>Vector of length <code>k</code> where <code>sampling.f[i]</code>
    is the proportion of species in state <code>i</code> that are present in
    the phylogeny.  A value of <code>c(0.5, 0.75, 1)</code> means that half of
    species in state 1, three quarters of species in state 2, and all
    species in state 3 are included in the phylogeny.  By default all
    species are assumed to be known</p></dd>


  <dt id="arg-strict">strict<a class="anchor" aria-label="anchor" href="#arg-strict"></a></dt>
<dd><p>The <code>states</code> vector is always checked to make sure
    that the values are integers on <code>1:k</code>.  If <code>strict</code> is
    <code>TRUE</code> (the default), then the additional check is made that
    <em>every</em> state is present.  The likelihood models tend to be
    poorly behaved where states are missing, but there are cases
    (missing intermediate states for meristic characters) where allowing
    such models may be useful.</p></dd>


  <dt id="arg-control">control<a class="anchor" aria-label="anchor" href="#arg-control"></a></dt>
<dd><p>List of control parameters for the ODE solver.  See
    details in <code><a href="make.bisse.html">make.bisse</a></code>.</p></dd>


  <dt id="arg-q-div">q.div<a class="anchor" aria-label="anchor" href="#arg-q-div"></a></dt>
<dd><p>Ratio of diversification rate to character change rate.
    Eventually this will be changed to allow for Mk2 to be used for
    estimating q parameters.</p></dd>


  <dt id="arg-yule">yule<a class="anchor" aria-label="anchor" href="#arg-yule"></a></dt>
<dd><p>Logical: should starting parameters be Yule estimates
    rather than birth-death estimates?</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>With more than 9 states, qij can be ambiguous (e.g. is q113 1-&gt;13 or
  11-&gt;3?).  To avoid this, the numbers are zero padded (so that the
  above would be q0113 or q1103 for 1-&gt;13 and 11-&gt;3 respectively).  It
  might be easier to rename the arguments in practice though.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="make.bisse.html">make.bisse</a></code> for the basic binary model, and
  <code><a href="make.musse.multitrait.html">make.musse.multitrait</a></code> for the case where the data are
  really combinations of binary traits.</p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Richard G. FitzJohn</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## Due to a change in sample() behaviour in newer R it is necessary to</span></span></span>
<span class="r-in"><span><span class="co">## use an older algorithm to replicate the previous examples</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric_version.html" class="external-link">getRversion</a></span><span class="op">(</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="st">"3.6.0"</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">RNGkind</a></span><span class="op">(</span>sample.kind <span class="op">=</span> <span class="st">"Rounding"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>non-uniform 'Rounding' sampler used</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## 1: BiSSE equivalence</span></span></span>
<span class="r-in"><span><span class="va">pars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.1</span>, <span class="fl">.2</span>, <span class="fl">.03</span>, <span class="fl">.04</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">phy</span> <span class="op">&lt;-</span> <span class="fu"><a href="simulate.html">tree.musse</a></span><span class="op">(</span><span class="va">pars</span>, <span class="fl">20</span>, x0<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Show that the likelihood functions give the same answers.  Ignore the</span></span></span>
<span class="r-in"><span><span class="co">## warning when creating the MuSSE function.</span></span></span>
<span class="r-in"><span><span class="va">lik.b</span> <span class="op">&lt;-</span> <span class="fu"><a href="make.bisse.html">make.bisse</a></span><span class="op">(</span><span class="va">phy</span>, <span class="va">phy</span><span class="op">$</span><span class="va">tip.state</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lik.m</span> <span class="op">&lt;-</span> <span class="fu">make.musse</span><span class="op">(</span><span class="va">phy</span>, <span class="va">phy</span><span class="op">$</span><span class="va">tip.state</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu">lik.b</span><span class="op">(</span><span class="va">pars</span><span class="op">)</span>, <span class="fu">lik.m</span><span class="op">(</span><span class="va">pars</span><span class="op">)</span>, tolerance<span class="op">=</span><span class="fl">1e-7</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Notice that default argument names are different between BiSSE and</span></span></span>
<span class="r-in"><span><span class="co">## MuSSE, but that the order is the same.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="argnames.html">argnames</a></span><span class="op">(</span><span class="va">lik.b</span><span class="op">)</span> <span class="co"># BiSSE: 0/1</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "lambda0" "lambda1" "mu0"     "mu1"     "q01"     "q10"    </span>
<span class="r-in"><span><span class="fu"><a href="argnames.html">argnames</a></span><span class="op">(</span><span class="va">lik.m</span><span class="op">)</span> <span class="co"># MuSSE: 1/2</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "lambda1" "lambda2" "mu1"     "mu2"     "q12"     "q21"    </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## 2: A 3-state example where movement is only allowed between</span></span></span>
<span class="r-in"><span><span class="co">## neighbouring states (1 &lt;-&gt; 2 &lt;-&gt; 3), and where speciation and</span></span></span>
<span class="r-in"><span><span class="co">## extinction rates increase moving from 1 -&gt; 2 -&gt; 3:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## You can get the expected argument order for any number of states</span></span></span>
<span class="r-in"><span><span class="co">## this way (sorry - clunky).  The help file also lists the order.</span></span></span>
<span class="r-in"><span><span class="fu">diversitree</span><span class="fu">:::</span><span class="fu">default.argnames.musse</span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] "lambda1" "lambda2" "lambda3" "mu1"     "mu2"     "mu3"     "q12"    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8] "q13"     "q21"     "q23"     "q31"     "q32"    </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Here are the parameters:</span></span></span>
<span class="r-in"><span><span class="va">pars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.1</span>,  <span class="fl">.15</span>,  <span class="fl">.2</span>,  <span class="co"># lambda 1, 2, 3</span></span></span>
<span class="r-in"><span>          <span class="fl">.03</span>, <span class="fl">.045</span>, <span class="fl">.06</span>, <span class="co"># mu 1, 2, 3</span></span></span>
<span class="r-in"><span>          <span class="fl">.05</span>, <span class="fl">0</span>,         <span class="co"># q12, q13</span></span></span>
<span class="r-in"><span>          <span class="fl">.05</span>, <span class="fl">.05</span>,       <span class="co"># q21, q23</span></span></span>
<span class="r-in"><span>          <span class="fl">0</span>,   <span class="fl">.05</span><span class="op">)</span>       <span class="co"># q31, q32</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">phy</span> <span class="op">&lt;-</span> <span class="fu"><a href="simulate.html">tree.musse</a></span><span class="op">(</span><span class="va">pars</span>, <span class="fl">30</span>, x0<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Extract history from simulated tree and plot</span></span></span>
<span class="r-in"><span><span class="co">## (colours are 1: black, 2: red, 3: blue)</span></span></span>
<span class="r-in"><span><span class="va">col</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"orange"</span>, <span class="st">"red"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">h</span> <span class="op">&lt;-</span> <span class="fu"><a href="history.from.sim.html">history.from.sim.discrete</a></span><span class="op">(</span><span class="va">phy</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">h</span>, <span class="va">phy</span>, cex<span class="op">=</span><span class="fl">.7</span>, col<span class="op">=</span><span class="va">col</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="make.musse-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## The states are numbered 1:3, rather than 0:1 in bisse.</span></span></span>
<span class="r-in"><span><span class="va">states</span> <span class="op">&lt;-</span> <span class="va">phy</span><span class="op">$</span><span class="va">tip.state</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">states</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> states</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1  2  3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 13  4 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## 2: Likelihood</span></span></span>
<span class="r-in"><span><span class="co">## Making a likelihood function is basically identical to bisse.  The</span></span></span>
<span class="r-in"><span><span class="co">## third argument needs to be the number of states.  In a future</span></span></span>
<span class="r-in"><span><span class="co">## version this will probably be max(states), but there are some</span></span></span>
<span class="r-in"><span><span class="co">## pitfalls about this that I am still worried about.</span></span></span>
<span class="r-in"><span><span class="va">lik</span> <span class="op">&lt;-</span> <span class="fu">make.musse</span><span class="op">(</span><span class="va">phy</span>, <span class="va">states</span>, <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Here are the arguments.  Even with three states, this is getting</span></span></span>
<span class="r-in"><span><span class="co">## ridiculous.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="argnames.html">argnames</a></span><span class="op">(</span><span class="va">lik</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] "lambda1" "lambda2" "lambda3" "mu1"     "mu2"     "mu3"     "q12"    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8] "q13"     "q21"     "q23"     "q31"     "q32"    </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Start with a fully constrained model, but still enforcing stepwise</span></span></span>
<span class="r-in"><span><span class="co">## changes (disallowing 1 &lt;-&gt; 3 shifts)</span></span></span>
<span class="r-in"><span><span class="va">lik.base</span> <span class="op">&lt;-</span> <span class="fu"><a href="constrain.html">constrain</a></span><span class="op">(</span><span class="va">lik</span>, <span class="va">lambda2</span> <span class="op">~</span> <span class="va">lambda1</span>, <span class="va">lambda3</span> <span class="op">~</span> <span class="va">lambda1</span>,</span></span>
<span class="r-in"><span>                      <span class="va">mu2</span> <span class="op">~</span> <span class="va">mu1</span>, <span class="va">mu3</span> <span class="op">~</span> <span class="va">mu1</span>,</span></span>
<span class="r-in"><span>                      <span class="va">q13</span> <span class="op">~</span> <span class="fl">0</span>, <span class="va">q21</span> <span class="op">~</span> <span class="va">q12</span>, <span class="va">q23</span> <span class="op">~</span> <span class="va">q12</span>, <span class="va">q31</span> <span class="op">~</span> <span class="fl">0</span>, <span class="va">q32</span> <span class="op">~</span> <span class="va">q12</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">starting.point.musse</span><span class="op">(</span><span class="va">phy</span>, <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit.base</span> <span class="op">&lt;-</span> <span class="fu"><a href="find.mle.html">find.mle</a></span><span class="op">(</span><span class="va">lik.base</span>, <span class="va">p</span><span class="op">[</span><span class="fu"><a href="argnames.html">argnames</a></span><span class="op">(</span><span class="va">lik.base</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Now, allow the speciation rates to vary:</span></span></span>
<span class="r-in"><span><span class="va">lik.lambda</span> <span class="op">&lt;-</span> <span class="fu"><a href="constrain.html">constrain</a></span><span class="op">(</span><span class="va">lik</span>, <span class="va">mu2</span> <span class="op">~</span> <span class="va">mu1</span>, <span class="va">mu3</span> <span class="op">~</span> <span class="va">mu1</span>,</span></span>
<span class="r-in"><span>                        <span class="va">q13</span> <span class="op">~</span> <span class="fl">0</span>, <span class="va">q21</span> <span class="op">~</span> <span class="va">q12</span>, <span class="va">q23</span> <span class="op">~</span> <span class="va">q12</span>, <span class="va">q31</span> <span class="op">~</span> <span class="fl">0</span>, <span class="va">q32</span> <span class="op">~</span> <span class="va">q12</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit.lambda</span> <span class="op">&lt;-</span> <span class="fu"><a href="find.mle.html">find.mle</a></span><span class="op">(</span><span class="va">lik.lambda</span>, <span class="va">p</span><span class="op">[</span><span class="fu"><a href="argnames.html">argnames</a></span><span class="op">(</span><span class="va">lik.lambda</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Very little improvement in fit (this *is* a small tree)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">fit.base</span>, lambda<span class="op">=</span><span class="va">fit.lambda</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Run an MCMC with this set.  Priors will be necessary (using the</span></span></span>
<span class="r-in"><span><span class="co">## usual exponential with mean of 2r)</span></span></span>
<span class="r-in"><span><span class="va">prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="make.prior.html">make.prior.exponential</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="va">p</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">p</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="mcmc.html">mcmc</a></span><span class="op">(</span><span class="va">lik.lambda</span>, <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit.lambda</span><span class="op">)</span>, nstep<span class="op">=</span><span class="fl">1000</span>, w<span class="op">=</span><span class="fl">1</span>,</span></span>
<span class="r-in"><span>                prior<span class="op">=</span><span class="va">prior</span>, print.every<span class="op">=</span><span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Posterior probability profile plots for the three speciation rates.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="profiles.plot.html">profiles.plot</a></span><span class="op">(</span><span class="va">samples</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, <span class="va">col</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.1</span>, <span class="fl">.15</span>, <span class="fl">.2</span><span class="op">)</span>, col<span class="op">=</span><span class="va">col</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Richard G. FitzJohn, Emma Goldberg, Karen Magnuson-Ford, Roger Sidje.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>


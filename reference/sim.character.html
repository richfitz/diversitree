<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Simulate a Character Distribution on a Tree — sim.character • diversitree</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Simulate a Character Distribution on a Tree — sim.character"><meta property="og:description" content="Simulate a character distribution (state of each species)
  under some simple models of trait evolution.  Currently this does not
  return the full history (node states, and state changes) but this may
  be added in a future version."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">diversitree</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.9-18</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Simulate a Character Distribution on a Tree</h1>
    
    <div class="hidden name"><code>sim.character.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Simulate a character distribution (state of each species)
  under some simple models of trait evolution.  Currently this does not
  return the full history (node states, and state changes) but this may
  be added in a future version.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">sim.character</span><span class="op">(</span><span class="va">tree</span>, <span class="va">pars</span>, x0<span class="op">=</span><span class="fl">0</span>, model<span class="op">=</span><span class="st">"bm"</span>, br<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="fu">make.sim.character</span><span class="op">(</span><span class="va">tree</span>, <span class="va">pars</span>, model<span class="op">=</span><span class="st">"bm"</span>, br<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>tree</dt>
<dd><p>A bifurcating phylogenetic tree, in <code>ape</code>
    “phylo” format.</p></dd>


  <dt>pars</dt>
<dd><p>A set of model parameters (see Details below), as the
    order and interpretation depends on the model.</p></dd>


  <dt>x0</dt>
<dd><p>Root state.  The default is zero, which may not make sense
    in all models.</p></dd>


  <dt>model</dt>
<dd><p>Character string specifying which model to evolve the
    character under.  Possible values are <code>"bm"</code>, <code>"ou"</code>,
    <code>"bbm"</code>, <code>"mk"</code> and <code>"meristic"</code>; see Details.</p></dd>


  <dt>br</dt>
<dd><p>For cases where none of the models specifiable through the
    <code>model</code> argument are sufficient, you can provide your own
    function.  The function must have arguments <code>x0</code>, <code>t</code>,
    which are the state at the base of a branch and the length of time
    to simulate over.  It must return a scalar state at the tip of the
    branch.  Future versions may change requirements of this function,
    especially to allow retention of character histories along
    branches.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>This function duplicates functionality in other packages; see
  <code>sim.char</code> in <code>geiger</code> in particular.  The main difference
  here is that for continuous characters, this does not use the
  variance-covariance matrix, which can make it much faster for very
  large trees.  I believe that this approach is similar to <code>fastBM</code>
  in <code>phytools</code>.</p>
<p></p><ul><li><p><code>model="bm"</code>: Brownian Motion.  Takes a single
    parameter, representing the rate of diffusion (must be positive)</p></li>
<li><p><code>model="ou"</code>: Ornstein-Uhlenbeck process.  Takes a vector
    of three parameters, representing the rate of diffusion, strength of
    restoring force, and the "optimum" value.  The first two parameters
    must be non-negative, and the rate of diffusion must be positive.</p></li>
<li><p><code>model="bbm"</code>: Bounded Brownian Motion.  Takes a vector
    of three parameters (<code>s2</code>, <code>c</code>, <code>d</code>), representing
    the rate of diffusion, lower and upper bound, respectively.  The
    rate of diffusion must be positive.</p>
<p><!-- % TODO: What is the orientation of the matrix: \item -->
    <code>model="mk"</code>: Mk model (see <code><a href="make.mkn.html">make.mkn</a></code>).  Takes a Q
    matrix as its argument.  The element <code>Q[i,j]</code> represents the
    rate of transition from state <code>i</code> to state <code>j</code>, and the
    diagonal elements must be such that <code>rowSums(Q)</code> is zero.</p>
<p><code>model="meristic"</code>: A special case of the Mk model, where the
    trait is meristic and character transitions are only possible
    between adjacent states.  There are three parameters (<code>k</code>,
    <code>up</code>, <code>down</code>), representing the number of states, and rate
    of character change up (from state <code>i</code> to <code>i+1</code>) and down.</p></li>
</ul></div>
    <div id="author">
    <h2>Author</h2>
    <p>Richard G. FitzJohn</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Richard G. FitzJohn, Emma Goldberg, Karen Magnuson-Ford, Roger Sidje.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>


<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Plot Character History — plot.history • diversitree</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Plot Character History — plot.history"><meta property="og:description" content="Both stochastic character mapping and simulation may create
  character histories.  This function plots these histories"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">diversitree</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.10-1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plot Character History</h1>

    <div class="hidden name"><code>plot.history.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Both stochastic character mapping and simulation may create
  character histories.  This function plots these histories</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'history'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">phy</span>, cols<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">states</span><span class="op">)</span>,</span>
<span>             states<span class="op">=</span><span class="va">x</span><span class="op">$</span><span class="va">states</span>,</span>
<span>             xlim<span class="op">=</span><span class="cn">NULL</span>, ylim<span class="op">=</span><span class="cn">NULL</span>, show.tip.label<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>             show.node.label<span class="op">=</span><span class="cn">FALSE</span>, show.tip.state<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>             show.node.state<span class="op">=</span><span class="cn">TRUE</span>, no.margin<span class="op">=</span><span class="cn">FALSE</span>, cex<span class="op">=</span><span class="fl">1</span>, font<span class="op">=</span><span class="fl">3</span>,</span>
<span>             srt<span class="op">=</span><span class="fl">0</span>, adj<span class="op">=</span><span class="fl">0</span>, label.offset<span class="op">=</span><span class="cn">NA</span>, lwd<span class="op">=</span><span class="fl">1</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <p></p>
<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>An object of class <code>history.discrete</code> containing a
    discrete character history.  This could be made by
    <code><a href="history.from.sim.html">history.from.sim.discrete</a></code>.</p></dd>

  <dt id="arg-phy">phy<a class="anchor" aria-label="anchor" href="#arg-phy"></a></dt>
<dd><p>The phylogeny used to generate the history.  Few checks are
    made to make sure that this is really correct, and all manner of
    terrible things might happen if these are not compatible.  This may
    change in future.</p></dd>

  <dt id="arg-cols">cols<a class="anchor" aria-label="anchor" href="#arg-cols"></a></dt>
<dd><p>A vector of colours.</p></dd>

  <dt id="arg-states">states<a class="anchor" aria-label="anchor" href="#arg-states"></a></dt>
<dd><p>The different state types.  Probably best to leave
    alone.</p></dd>

  <dt id="arg-xlim">xlim<a class="anchor" aria-label="anchor" href="#arg-xlim"></a></dt>
<dd><p>Plot x-limits (optional).</p></dd>

  <dt id="arg-ylim">ylim<a class="anchor" aria-label="anchor" href="#arg-ylim"></a></dt>
<dd><p>Plot y-limits (optional).</p></dd>

  <dt id="arg-show-tip-label">show.tip.label<a class="anchor" aria-label="anchor" href="#arg-show-tip-label"></a></dt>
<dd><p>Logical: show the species tip labels?</p></dd>

  <dt id="arg-show-node-label">show.node.label<a class="anchor" aria-label="anchor" href="#arg-show-node-label"></a></dt>
<dd><p>Logical: show the species node labels?</p></dd>

  <dt id="arg-show-tip-state">show.tip.state<a class="anchor" aria-label="anchor" href="#arg-show-tip-state"></a></dt>
<dd><p>Logical: draw a symbol at the tips to indicate
    tip state?</p></dd>

  <dt id="arg-show-node-state">show.node.state<a class="anchor" aria-label="anchor" href="#arg-show-node-state"></a></dt>
<dd><p>Logical: draw a symbol at the nodes to indicate
    node state?</p></dd>

  <dt id="arg-no-margin">no.margin<a class="anchor" aria-label="anchor" href="#arg-no-margin"></a></dt>
<dd><p>Supress drawing of margins around the plot</p></dd>

  <dt id="arg-cex">cex<a class="anchor" aria-label="anchor" href="#arg-cex"></a></dt>
<dd><p>Font and symbol scaling factor.</p></dd>

  <dt id="arg-font">font<a class="anchor" aria-label="anchor" href="#arg-font"></a></dt>
<dd><p>Font used for tip and node labels (see
    <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></code>).</p></dd>

  <dt id="arg-srt">srt<a class="anchor" aria-label="anchor" href="#arg-srt"></a></dt>
<dd><p>String rotation for tip and node labels.</p></dd>

  <dt id="arg-adj">adj<a class="anchor" aria-label="anchor" href="#arg-adj"></a></dt>
<dd><p>Label <code>adj</code>ustment (see <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></code>).</p></dd>

  <dt id="arg-label-offset">label.offset<a class="anchor" aria-label="anchor" href="#arg-label-offset"></a></dt>
<dd><p>Horizontal offset of tip and node labels, in
    branch length units.</p></dd>

  <dt id="arg-lwd">lwd<a class="anchor" aria-label="anchor" href="#arg-lwd"></a></dt>
<dd><p>Line width</p></dd>

  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments (currently ignored)</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>This attempts to be as compatible with <code>ape</code>'s plotting functions
  as possible, but currently implements only right-facing cladegrams.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Richard G. FitzJohn</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## Due to a change in sample() behaviour in newer R it is necessary to</span></span></span>
<span class="r-in"><span><span class="co">## use an older algorithm to replicate the previous examples</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric_version.html" class="external-link">getRversion</a></span><span class="op">(</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="st">"3.6.0"</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">RNGkind</a></span><span class="op">(</span>sample.kind <span class="op">=</span> <span class="st">"Rounding"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>non-uniform 'Rounding' sampler used</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Simulate a tree, but retain extinct species.</span></span></span>
<span class="r-in"><span><span class="va">pars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.1</span>, <span class="fl">.2</span>, <span class="fl">.03</span>, <span class="fl">.04</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span><span class="op">)</span> <span class="co"># BiSSE pars</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">phy</span> <span class="op">&lt;-</span> <span class="fu"><a href="simulate.html">tree.bisse</a></span><span class="op">(</span><span class="va">pars</span>, <span class="fl">20</span>, x0<span class="op">=</span><span class="fl">0</span>, include.extinct<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Create a 'history' from the information produced by the simulation</span></span></span>
<span class="r-in"><span><span class="co">## and plot this</span></span></span>
<span class="r-in"><span><span class="va">h</span> <span class="op">&lt;-</span> <span class="fu"><a href="history.from.sim.html">history.from.sim.discrete</a></span><span class="op">(</span><span class="va">phy</span>, <span class="fl">0</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">h</span>, <span class="va">phy</span>, cex<span class="op">=</span><span class="fl">.7</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot.history-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Prune the extinct taxa.</span></span></span>
<span class="r-in"><span><span class="va">phy2</span> <span class="op">&lt;-</span> <span class="fu"><a href="simulate.html">prune</a></span><span class="op">(</span><span class="va">phy</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## The history must be recreated for this pruned tree:</span></span></span>
<span class="r-in"><span><span class="va">h2</span> <span class="op">&lt;-</span> <span class="fu"><a href="history.from.sim.html">history.from.sim.discrete</a></span><span class="op">(</span><span class="va">phy2</span>, <span class="fl">0</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">h2</span>, <span class="va">phy2</span>, cex<span class="op">=</span><span class="fl">.7</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot.history-2.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Richard G. FitzJohn, Emma Goldberg, Karen Magnuson-Ford, Roger Sidje.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>


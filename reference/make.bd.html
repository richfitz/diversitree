<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Constant Rate Birth-Death Models — make.bd • diversitree</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Constant Rate Birth-Death Models — make.bd"><meta property="og:description" content="Prepare to run a constant rate birth-death model on a
  phylogenetic tree.  This fits the Nee et al. 1994 equation,
  duplicating the birthdeath function in ape.  Differences with
  that function include (1) the function is not constrained to positive
  diversification rates (mu can exceed lambda), (2) [eventual] support
  for both random taxon sampling and unresolved terminal clades (but see
  bd.ext), and (3) run both MCMC and MLE fits to birth death
  trees."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">diversitree</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.9-19</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Constant Rate Birth-Death Models</h1>
    
    <div class="hidden name"><code>make.bd.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Prepare to run a constant rate birth-death model on a
  phylogenetic tree.  This fits the Nee et al. 1994 equation,
  duplicating the <code>birthdeath</code> function in ape.  Differences with
  that function include (1) the function is not constrained to positive
  diversification rates (mu can exceed lambda), (2) [eventual] support
  for both random taxon sampling and unresolved terminal clades (but see
  <code>bd.ext</code>), and (3) run both MCMC and MLE fits to birth death
  trees.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">make.bd</span><span class="op">(</span><span class="va">tree</span>, sampling.f<span class="op">=</span><span class="cn">NULL</span>, unresolved<span class="op">=</span><span class="cn">NULL</span>, times<span class="op">=</span><span class="cn">NULL</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">make.yule</span><span class="op">(</span><span class="va">tree</span>, sampling.f<span class="op">=</span><span class="cn">NULL</span>, unresolved<span class="op">=</span><span class="cn">NULL</span>, times<span class="op">=</span><span class="cn">NULL</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">starting.point.bd</span><span class="op">(</span><span class="va">tree</span>, yule<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>tree</dt>
<dd><p>An ultrametric bifurcating phylogenetic tree, in
    <code>ape</code> “phylo” format.</p></dd>

  
  <dt>times</dt>
<dd><p>Vector of branching times, as returned by
    <code>branching.times</code>.  You don't need to use this unless you know
    that you need to use this.  Don't use it at the same time as
    <code>tree</code>.</p></dd>

  
  <dt>sampling.f</dt>
<dd><p>Probability of an extant species being included in
    the phylogeny (sampling fraction).  By default, all extant species are
    assumed to be included.</p></dd>


  <dt>unresolved</dt>
<dd><p>Unresolved clade information.  This is a named
    vector, with the number of species as the value and names
    corresponding to tip labels.  Tips that represent a single species
    should not be included in this vector.  For example
    <code>sp1=10, sp2=2</code>, would mean that <code>sp1</code> represents 10
    species, while <code>sp2</code> represents two.  These labels must exist
    in <code>tree$tip.label</code> and all other tips are assumed to
    represent one species.</p></dd>

  
  <dt>yule</dt>
<dd><p>Should the starting point function return a Yule model
    (zero extinction rate)?</p></dd>


  <dt>control</dt>
<dd><p>List of control parameters.  The element <code>method</code>
    can be either <code>nee</code> or <code>ode</code> to compute the likelihood
    using the equation from Nee et al. (1994) or in a BiSSE-style ODE
    approach respectively.  <code>nee</code> should be faster, and <code>ode</code>
    is provided for completeness (and forms the basis of other methods).
    When <code>ode</code> is selected, other elements of <code>control</code> affect
    the behaviour of the ODE solver: see details in
    <code><a href="make.bisse.html">make.bisse</a></code>.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p><code>make.bd</code> returns a function of class <code>bd</code>.
  This function has argument list (and default values)</p><div class="sourceCode"><pre><code><span></span>
<span>    <span class="fu">f</span><span class="op">(</span><span class="va">pars</span>, prior<span class="op">=</span><span class="cn">NULL</span>, condition.surv<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span>  </span></code></pre></div><p>The arguments are interpreted as</p><ul><li><p><code>pars</code> A vector of two parameters, in the order
    <code>lambda</code>, <code>mu</code>.</p></li>
<li><p><code>prior</code>: a valid prior.  See <code><a href="make.prior.html">make.prior</a></code> for
    more information.</p></li>
<li><p><code>condition.surv</code> (logical): should the likelihood
    calculation condition on survival of two lineages and the speciation
    event subtending them?  This is done by default, following Nee et
    al. 1994.</p></li>
</ul><p>The function "ode" method is included for completeness, but should not
  be taken too seriously.  It uses an alternative ODE-based approach,
  more similar to most diversitree models, to compute the likelihood.
  It exists so that other models that extend the birth-death models may
  be tested.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="constrain.html">constrain</a></code> for making submodels, <code><a href="find.mle.html">find.mle</a></code>
  for ML parameter estimation, <code><a href="mcmc.html">mcmc</a></code> for MCMC integration,
  and <code><a href="make.bisse.html">make.bisse</a></code> for state-dependent birth-death models.</p></div>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Nee S., May R.M., and Harvey P.H. 1994. The reconstructed
  evolutionary process. Philos.  Trans. R. Soc. Lond. B
  Biol. Sci. 344:305-311.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Richard G. FitzJohn</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## Simulate a tree under a constant rates birth-death model and look at</span></span></span>
<span class="r-in"><span><span class="co">## the maximum likelihood speciation/extinction parameters:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">phy</span> <span class="op">&lt;-</span> <span class="fu"><a href="simulate.html">trees</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.1</span>, <span class="fl">.03</span><span class="op">)</span>, <span class="st">"bd"</span>, max.taxa<span class="op">=</span><span class="fl">25</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">lik</span> <span class="op">&lt;-</span> <span class="fu">make.bd</span><span class="op">(</span><span class="va">phy</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## By default, optimisation gives a lambda close to 0.1 and extremely</span></span></span>
<span class="r-in"><span><span class="co">## small mu:</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="find.mle.html">find.mle</a></span><span class="op">(</span><span class="va">lik</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.1</span>, <span class="fl">.03</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       lambda           mu </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.021010e-01 6.108235e-07 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## The above optimisation uses the algorithm \link{nlm} for</span></span></span>
<span class="r-in"><span><span class="co">## compatibility with ape's \link{birthdeath}.  This can be slightly</span></span></span>
<span class="r-in"><span><span class="co">## improved by using \link{optim} for the optimisation, which allows</span></span></span>
<span class="r-in"><span><span class="co">## bounds to be specified:</span></span></span>
<span class="r-in"><span><span class="va">fit.o</span> <span class="op">&lt;-</span> <span class="fu"><a href="find.mle.html">find.mle</a></span><span class="op">(</span><span class="va">lik</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.1</span>, <span class="fl">.03</span><span class="op">)</span>, method<span class="op">=</span><span class="st">"optim"</span>, lower<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit.o</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lambda         mu </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.09613913 0.00000000 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik</a></span><span class="op">(</span><span class="va">fit.o</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span> <span class="co"># slight improvement</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 'log Lik.' 0.04247715 (df=2)</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Special case methods are worked out for the Yule model, for which</span></span></span>
<span class="r-in"><span><span class="co">## analytic solutions are available.  Compare a direct fit of the Yule</span></span></span>
<span class="r-in"><span><span class="co">## model with one where mu is constrained to be zero:</span></span></span>
<span class="r-in"><span><span class="va">lik.yule</span> <span class="op">&lt;-</span> <span class="fu">make.yule</span><span class="op">(</span><span class="va">phy</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lik.mu0</span> <span class="op">&lt;-</span> <span class="fu"><a href="constrain.html">constrain</a></span><span class="op">(</span><span class="va">lik</span>, <span class="va">mu</span> <span class="op">~</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## The same to a reasonable tolerance:</span></span></span>
<span class="r-in"><span><span class="va">fit.yule</span> <span class="op">&lt;-</span> <span class="fu"><a href="find.mle.html">find.mle</a></span><span class="op">(</span><span class="va">lik.yule</span>, <span class="fl">.1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit.mu0</span> <span class="op">&lt;-</span> <span class="fu"><a href="find.mle.html">find.mle</a></span><span class="op">(</span><span class="va">lik.mu0</span>, <span class="fl">.1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">fit.yule</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, <span class="va">fit.mu0</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, tolerance<span class="op">=</span><span class="fl">1e-6</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## There is no significant improvement in the fit by including the mu</span></span></span>
<span class="r-in"><span><span class="co">## parameter (unsurprising as the ML value was zero)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">fit.o</span>, yule<span class="op">=</span><span class="va">fit.yule</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Df  lnLik    AIC      ChiSq Pr(&gt;|Chi|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> full  2 -22.08 48.161                      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> yule  1 -22.08 46.161 3.0127e-12          1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Optimisation can be done without conditioning on survival:</span></span></span>
<span class="r-in"><span><span class="va">fit.nosurv</span> <span class="op">&lt;-</span> <span class="fu"><a href="find.mle.html">find.mle</a></span><span class="op">(</span><span class="va">lik</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.1</span>, <span class="fl">.03</span><span class="op">)</span>, method<span class="op">=</span><span class="st">"optim"</span>, lower<span class="op">=</span><span class="fl">0</span>,</span></span>
<span class="r-in"><span>                       condition.surv<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit.nosurv</span><span class="op">)</span> <span class="co"># higher lambda than before</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    lambda        mu </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.1003191 0.0000000 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Look at the marginal likelihoods, computed through MCMC (see</span></span></span>
<span class="r-in"><span><span class="co">## \link{mcmc} for details, and increase nsteps for smoother</span></span></span>
<span class="r-in"><span><span class="co">## plots [takes longer]).</span></span></span>
<span class="r-in"><span><span class="va">samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="mcmc.html">mcmc</a></span><span class="op">(</span><span class="va">lik</span>, <span class="va">fit</span><span class="op">$</span><span class="va">par</span>, nsteps<span class="op">=</span><span class="fl">500</span>,</span></span>
<span class="r-in"><span>                lower<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="op">-</span><span class="cn">Inf</span><span class="op">)</span>, upper<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">Inf</span>, <span class="cn">Inf</span><span class="op">)</span>, w<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.1</span>, <span class="fl">.1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                fail.value<span class="op">=</span><span class="op">-</span><span class="cn">Inf</span>, print.every<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 100: {0.2099, 0.1296} -&gt; -25.08160</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 200: {0.1453, 0.0975} -&gt; -23.46928</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 300: {0.1183, 0.0465} -&gt; -22.59005</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 400: {0.1451, 0.0135} -&gt; -23.85709</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 500: {0.1416, 0.0799} -&gt; -23.13356</span>
<span class="r-in"><span><span class="va">samples</span><span class="op">$</span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">samples</span>, <span class="va">lambda</span> <span class="op">-</span> <span class="va">mu</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Plot the profiles (see \link{profiles.plot}).</span></span></span>
<span class="r-in"><span><span class="co">## The vertical lines are the simulated parameters, which match fairly</span></span></span>
<span class="r-in"><span><span class="co">## well with the estimated ones.</span></span></span>
<span class="r-in"><span><span class="va">col</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"green3"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="profiles.plot.html">profiles.plot</a></span><span class="op">(</span><span class="va">samples</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lambda"</span>, <span class="st">"mu"</span>, <span class="st">"r"</span><span class="op">)</span><span class="op">]</span>, col.line<span class="op">=</span><span class="va">col</span>, las<span class="op">=</span><span class="fl">1</span>,</span></span>
<span class="r-in"><span>              legend<span class="op">=</span><span class="st">"topright"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="fl">0</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.1</span>, <span class="fl">.03</span>, <span class="fl">.07</span><span class="op">)</span>, col<span class="op">=</span><span class="va">col</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="make.bd-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Sample the phylogeny to include 20 of the species, and run the</span></span></span>
<span class="r-in"><span><span class="co">## likelihood search assuming random sampling:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">phy2</span> <span class="op">&lt;-</span> <span class="fu">drop.tip</span><span class="op">(</span><span class="va">phy</span>, <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">25</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lik2</span> <span class="op">&lt;-</span> <span class="fu">make.bd</span><span class="op">(</span><span class="va">phy2</span>, sampling.f<span class="op">=</span><span class="fl">20</span><span class="op">/</span><span class="fl">25</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu"><a href="find.mle.html">find.mle</a></span><span class="op">(</span><span class="va">lik2</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.1</span>, <span class="fl">.03</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## The ODE based version gives comparable results.  However, it is</span></span></span>
<span class="r-in"><span><span class="co">## about 55x slower.</span></span></span>
<span class="r-in"><span><span class="va">lik.ode</span> <span class="op">&lt;-</span> <span class="fu">make.bd</span><span class="op">(</span><span class="va">phy</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">"ode"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu">lik.ode</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">)</span>, <span class="fu">lik</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">)</span>, tolerance<span class="op">=</span><span class="fl">2e-7</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Richard G. FitzJohn, Emma Goldberg, Karen Magnuson-Ford, Roger Sidje.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>


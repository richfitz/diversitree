<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Geographic State Speciation and Extinction Model: Time Dependent
  Models — make.geosse.t • diversitree</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Geographic State Speciation and Extinction Model: Time Dependent
  Models — make.geosse.t"><meta property="og:description" content="Prepare to run time dependent GeoSSE (Geographic State
  Speciation and Extinction) on a phylogenetic tree and character
  distribution. This function creates a likelihood function that can be
  used in maximum likelihood or Bayesian
  inference."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">diversitree</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.9-20</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Geographic State Speciation and Extinction Model: Time Dependent
  Models</h1>
    
    <div class="hidden name"><code>make.geosse.t.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Prepare to run time dependent GeoSSE (Geographic State
  Speciation and Extinction) on a phylogenetic tree and character
  distribution. This function creates a likelihood function that can be
  used in <a href="find.mle.html">maximum likelihood</a> or <a href="mcmc.html">Bayesian</a>
  inference.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">make.geosse.t</span><span class="op">(</span><span class="va">tree</span>, <span class="va">states</span>, <span class="va">functions</span>, sampling.f<span class="op">=</span><span class="cn">NULL</span>, strict<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>              control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>, truncate<span class="op">=</span><span class="cn">FALSE</span>, spline.data<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>tree</dt>
<dd><p>A phylogenetic tree, in <code>ape</code> “phylo” format.</p></dd>

  
  <dt>states</dt>
<dd><p>A vector of character states, each of which must be 0
    (in both regions/widespread; AB), 1 or 2 (endemic to one region; A or
    B), or <code>NA</code> if the state is unknown.  This vector must have names
    that correspond to the tip labels in the phylogenetic tree
    (<code>tree$tip.label</code>).</p></dd>

    
  <dt>functions</dt>
<dd><p>A named character vector of functions of time.  See
    details.</p></dd>


  <dt>sampling.f</dt>
<dd><p>Vector of length 3 with the estimated proportion of
    extant species in states 0, 1 and 2 that are included in the
    phylogeny.  A value of <code>c(0.5, 0.75, 1)</code> means that half of
    species in state 0, three quarters of species in state 1, and all the
    species in state 2 are included in the phylogeny.  By default all
    species are assumed to be known.</p></dd>

 
  <dt>strict</dt>
<dd><p>The <code>states</code> vector is always checked to make sure
    that the values are 0, 1 and 2 only. If <code>strict</code> is <code>TRUE</code>
    (the default), then the additional check is made that <em>every</em>
    state is present.  The likelihood models tend to be poorly behaved
    where states are missing.</p></dd>


  <dt>control</dt>
<dd><p>List of control parameters for the ODE solver.  See
    details in <code><a href="make.bisse.html">make.bisse</a></code>.</p></dd>

  
  <dt>truncate</dt>
<dd><p>Logical, indicating if functions should be truncated
    to zero when negative (rather than causing an error).  May be
    scalar (applying to all functions) or a vector (of length 7).</p></dd>


  <dt>spline.data</dt>
<dd><p>List of data for spline-based time functions.  See
    details in <code><a href="make.bisse.td.html">make.bisse.t</a></code></p></dd>
</dl><p>.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Please see <code><a href="make.bisse.td.html">make.bisse.t</a></code> for further details.</p>
<p><code>make.geosse.t</code> returns a function of class <code>geosse.t</code>.</p>  
<p>The <code>funtions</code> is a vector of named functions of time.  For
  example, to have speciation rates be linear functions of time, while
  the extinction and dispersal rates be constant with respect to time,
  one can do</p><div class="sourceCode"><pre><code><span><span class="va">functions</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"linear.t"</span>, <span class="st">"constant.t"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><p>.  The functions here must have <code>t</code> as their first
  argument, interpreted as time back from the present.  See
  <code><a href="make.bisse.td.html">make.bisse.t</a></code> for more information, and for some
  potentially useful time functions.</p>  
<p>The function has argument list (and default values):</p>
<p></p><div class="sourceCode"><pre><code><span></span>
<span>    <span class="fu">f</span><span class="op">(</span><span class="va">pars</span>, condition.surv<span class="op">=</span><span class="cn">FALSE</span>, root<span class="op">=</span><span class="va">ROOT.OBS</span>, root.p<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>      intermediates<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span>  </span></code></pre></div>
  
<p>The parameter vector pars is ordered <code>sA</code>, <code>sB</code>, <code>sAB</code>,
  <code>xA</code>, <code>xB</code>, <code>dA</code>, <code>dB</code>. Unresolved clade methods
  are not available for GeoSSE. With three states, it would rapidly
  become computationally infeasible.  The arguments of this function are
  also explained in <code><a href="make.bisse.html">make.bisse</a></code>.</p>  
<p><code>starting.point.geosse</code> produces a first-guess set of parameters,
  ignoring character states.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="constrain.html">constrain</a></code> for making submodels and reduce number
  of parameters, <code><a href="find.mle.html">find.mle</a></code> for ML parameter estimation,
  <code><a href="mcmc.html">mcmc</a></code> for MCMC integration, <code><a href="make.bisse.html">make.bisse</a></code> and
  <code><a href="make.bisse.td.html">make.bisse.t</a></code> for further relevant examples.</p>
<p>The help page for <code><a href="find.mle.html">find.mle</a></code> has further examples of ML
  searches on full and constrained BiSSE models.  Things work similarly
  for GeoSSE and GeoSSE.t, just with different parameters.</p>
<p>See <code><a href="make.geosse.html">make.geosse</a></code> for explanation of the base model.</p></div>
    </div>
    <div id="warning">
    <h2>Warning</h2>
    <p>This computer intensive code is experimental!</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>FitzJohn R.G. 2012. Diversitree: comparative phylogenetic analyses of 
  diversification in R. Methods in Ecology and Evolution. 3, 1084-1092.</p>
<p>FitzJohn R.G., Maddison W.P., and Otto S.P. 2009. Estimating
  trait-dependent speciation and extinction rates from incompletely
  resolved phylogenies. Syst. Biol. 58:595-611.</p>  
<p>Goldberg E.E., Lancaster L.T., and Ree R.H. 2011. Phylogenetic
  inference of reciprocal effects between geographic range evolution and
  diversification. Syst. Biol. 60:451-465.</p>
<p>Maddison W.P., Midford P.E., and Otto S.P. 2007. Estimating
  a binary character's effect on speciation and
  extinction. Syst. Biol. 56:701-710.</p>
<p>Nee S., May R.M., and Harvey P.H. 1994. The reconstructed
  evolutionary process. Philos.  Trans. R. Soc. Lond. B
  Biol. Sci. 344:305-311.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Jonathan Rolland</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## Due to a change in sample() behaviour in newer R it is necessary to</span></span></span>
<span class="r-in"><span><span class="co">## use an older algorithm to replicate the previous examples</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric_version.html" class="external-link">getRversion</a></span><span class="op">(</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="st">"3.6.0"</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">RNGkind</a></span><span class="op">(</span>sample.kind <span class="op">=</span> <span class="st">"Rounding"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>non-uniform 'Rounding' sampler used</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Parameter values</span></span></span>
<span class="r-in"><span><span class="va">pars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">0.5</span>, <span class="fl">1.0</span>, <span class="fl">0.7</span>, <span class="fl">0.7</span>, <span class="fl">2.5</span>, <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">pars</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">diversitree</span><span class="fu">:::</span><span class="fu">default.argnames.geosse</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Simulate a tree</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">phy</span> <span class="op">&lt;-</span> <span class="fu"><a href="simulate.html">tree.geosse</a></span><span class="op">(</span><span class="va">pars</span>, max.t<span class="op">=</span><span class="fl">4</span>, x0<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## See the data</span></span></span>
<span class="r-in"><span><span class="va">statecols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AB"</span><span class="op">=</span><span class="st">"purple"</span>, <span class="st">"A"</span><span class="op">=</span><span class="st">"blue"</span>, <span class="st">"B"</span><span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">phy</span>, tip.color<span class="op">=</span><span class="va">statecols</span><span class="op">[</span><span class="va">phy</span><span class="op">$</span><span class="va">tip.state</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span>, cex<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="make.geosse.t-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Create your list of functions. Its length corresponds to the number</span></span></span>
<span class="r-in"><span><span class="co">## of parameters (speciation, extinction and dispersal) you want to</span></span></span>
<span class="r-in"><span><span class="co">## estimate.</span></span></span>
<span class="r-in"><span><span class="co">## For an unconstrained model, at least 7 parameters are estimated for</span></span></span>
<span class="r-in"><span><span class="co">## sA, sB, sAB, xA, xB, dA, dB.</span></span></span>
<span class="r-in"><span><span class="co">## In the case you want to define a model with linear functions of</span></span></span>
<span class="r-in"><span><span class="co">## speciation and extinction, and constant dispersal:</span></span></span>
<span class="r-in"><span><span class="va">functions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"linear.t"</span>, <span class="st">"constant.t"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Create the likelihood function</span></span></span>
<span class="r-in"><span><span class="va">lik</span> <span class="op">&lt;-</span> <span class="fu">make.geosse.t</span><span class="op">(</span><span class="va">phy</span>, <span class="va">phy</span><span class="op">$</span><span class="va">tip.state</span>, <span class="va">functions</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## This function will estimate a likelihood from 12 parameters.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="argnames.html">argnames</a></span><span class="op">(</span><span class="va">lik</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] "sA.c"  "sA.m"  "sB.c"  "sB.m"  "sAB.c" "sAB.m" "xA.c"  "xA.m"  "xB.c" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10] "xB.m"  "dA"    "dB"   </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Imagine that you want to get an estimate of the likelihood from a</span></span></span>
<span class="r-in"><span><span class="co">## known set of parameters.</span></span></span>
<span class="r-in"><span><span class="va">pars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.01</span>,<span class="fl">0.001</span>,<span class="fl">0.01</span>,<span class="fl">0.001</span>,<span class="fl">0.01</span>,<span class="fl">0.001</span>,<span class="fl">0.02</span>,<span class="fl">0.002</span>,<span class="fl">0.02</span>,<span class="fl">0.002</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">pars</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="argnames.html">argnames</a></span><span class="op">(</span><span class="va">lik</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">lik</span><span class="op">(</span><span class="va">pars</span><span class="op">)</span> <span class="co"># -640.1644</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -571.0267</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## A guess at a starting point from character independent birth-death</span></span></span>
<span class="r-in"><span><span class="co">## model (constant across time) .</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="make.geosse.html">starting.point.geosse</a></span><span class="op">(</span><span class="va">phy</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#it only gives 7 parameters for time-constant model.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "sA"  "sB"  "sAB" "xA"  "xB"  "dA"  "dB" </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## it can be modified for time-dependent with a guess on the slopes of</span></span></span>
<span class="r-in"><span><span class="co">## speciation and extinction rates.</span></span></span>
<span class="r-in"><span><span class="va">p.t</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">p</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="fl">0.001</span>,<span class="va">p</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,<span class="fl">0.001</span>,<span class="va">p</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,<span class="fl">0.001</span>,<span class="va">p</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>,<span class="fl">0.001</span>,<span class="va">p</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span>,<span class="fl">0.001</span>,<span class="va">p</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span>,<span class="va">p</span><span class="op">[</span><span class="fl">7</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">p.t</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="argnames.html">argnames</a></span><span class="op">(</span><span class="va">lik</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Start an ML search from this point (takes from one minute to a very</span></span></span>
<span class="r-in"><span><span class="co">## long time depending on your computer).</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="find.mle.html">find.mle</a></span><span class="op">(</span><span class="va">lik</span>, <span class="va">p.t</span>, method<span class="op">=</span><span class="st">"subplex"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit</span><span class="op">$</span><span class="va">logLik</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## A model with constraints on the dispersal rates.</span></span></span>
<span class="r-in"><span><span class="va">lik.d</span> <span class="op">&lt;-</span> <span class="fu"><a href="constrain.html">constrain</a></span><span class="op">(</span><span class="va">lik</span>, <span class="va">dA</span> <span class="op">~</span> <span class="va">dB</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##Now dA and dB are the same parameter dB.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="argnames.html">argnames</a></span><span class="op">(</span><span class="va">lik.d</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] "sA.c"  "sA.m"  "sB.c"  "sB.m"  "sAB.c" "sAB.m" "xA.c"  "xA.m"  "xB.c" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10] "xB.m"  "dB"   </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##The parameter dA must be removed from maximum likelihood initial parameters</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">fit.d</span> <span class="op">&lt;-</span> <span class="fu"><a href="find.mle.html">find.mle</a></span><span class="op">(</span><span class="va">lik.d</span>, <span class="va">p.t</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">p.t</span><span class="op">)</span><span class="op">==</span><span class="st">"dA"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit</span><span class="op">$</span><span class="va">logLik</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Richard G. FitzJohn, Emma Goldberg, Karen Magnuson-Ford, Roger Sidje.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

